# Cargo Chec

A cargo subcommand that runs `cargo check`, filters Rust errors/warnings, and outputs them as a JSON array of strings. Perfect for CI/CD, scripts, or AI tools needing structured error data.

## Quick Start

1. **Install globally**: `cargo install cargo-chec`
2. **Run in any Rust project**: `cargo chec`

Outputs a JSON array like `["Error (severity 8)...", "Related..."]`. No errors? `[]`.

## Installation

```bash
cargo install cargo-chec
```

Requires Rust and Cargo.

## Features

- **Integrated Check**: Runs `cargo check --message-format=json` automatically.
- **Smart Filtering**: Only shows errors/warnings (severity >= 4).
- **Structured Output**: JSON array of strings for easy parsing.
- **Flexible Input**: Supports files, stdin, or default cargo check.
- **Fast & Lean**: Rust-based with efficient JSON filtering.

## Usage

### Default: Run and Check
```bash
cd your-rust-project
cargo checkmate
# Output: ["Error (severity 8) from rustc in src/main.rs at line 1:1-1:10: Message"]
```

### Custom Input
```bash
# From file
cargo checkmate --input logs.json

# From stdin
cat logs.json | cargo checkmate --input -
```

### Output Format
JSON array of strings:
```json
[
  "Error (severity 8) from rustc in src/main.rs at line 1:1-1:10: Error message",
  "Related: In src/lib.rs at line 5:1-5:5: Related note"
]
```

Empty on no issues: `[]`.

## Example

In a project with errors:
```bash
$ cargo chec
["Error (severity 8) from rustc in src/main.rs at line 1:1-1:10: Example error"]
```

## Troubleshooting

- **Command not found?** Run `cargo install cargo-chec`.
- **No output?** Project has no errors/warnings, or cargo check failed.
- **Invalid JSON?** If using custom input, ensure valid JSON array.

## Contributing

Open issues/PRs on GitHub. Built for the Rust ecosystem.

## Releasing

Use the provided Justfile for release tasks:

```bash
# Run all checks
just check

# Dry-run publish
just dry-run

# Full release
just release
```

Requires `just` (install via `cargo install just`).

---

## For AI Agents: Workspace Specifications

This section provides structured details for AI tools to understand and interact with the codebase.

### Project Structure
- **Root Directory**: `cargo-chec/` (rename from cargo-chec)
- **Source Code**: `src/main.rs` (single-file binary)
- **Configuration**: `Cargo.toml` (dependencies and metadata)
- **Scripts**: `scripts/` (sh scripts for release tasks)
- **Justfile**: `Justfile` (command runner for release)
- **Build Artifacts**: `target/` (generated by Cargo)
- **Documentation**: `README.md` (this file)

### Key Dependencies
- `cw-jsonfilter` (GitHub: DA0-DA0/dao-contracts): Filtering for severity.
- `serde` & `serde_json`: JSON parsing/serialization.
- `clap`: CLI args.

### Build Commands
- **Local**: `cargo build --release` â†’ `target/release/cargo-chec`
- **Lint**: `cargo clippy`
- **Format**: `cargo fmt`
- **Test**: `cargo test`
- **Publish**: `cargo publish`
- **Release Scripts**: Use `just` with Justfile (e.g., `just check`, `just release`)

### Runtime Behavior
- **Entry Point**: `main()` in `src/main.rs`
- **Input**: If no `--input`, runs `cargo check --message-format=json`.
- **Filtering**: `CwJsonFilter` for severity >=4.
- **Output**: JSON array of strings to stdout.
- **Error Handling**: JSON array or stderr messages.

### Code Style
- Idiomatic Rust with `?` and structs.
- No comments.
- Edition 2021, rustfmt-compliant.

Use for autonomous navigation/modification.