# Cargo Chec

A cargo subcommand that wraps `cargo check`, filters Rust errors/warnings, and outputs them as a JSON array of strings. Perfect for CI/CD, scripts, or AI tools needing structured error data.

## Quick Start

1. **Install globally**: `cargo install cargo-chec`
2. **Run in any Rust project**: `cargo chec`

Outputs a JSON array like `["Error (severity 5)...", "Related..."]`. No errors? `[]`.

## Installation

```bash
cargo install cargo-chec
```

Requires Rust and Cargo.

## Features

- **Full cargo check support**: All cargo check flags pass through (--release, --package, --all-targets, etc.)
- **Smart Filtering**: Only shows errors (severity 5) and warnings (severity 4)
- **Structured Output**: JSON array of strings for easy parsing
- **Flexible Input**: Supports files, stdin, or default cargo check
- **Fast & Lean**: Minimal dependencies (clap, serde_json)

## Usage

### Default: Run cargo check

```bash
cd your-rust-project
cargo chec
# Output: ["Error (severity 5) from rustc in src/main.rs at line 1:1-10: Message"]
```

### With cargo check flags

All cargo check flags are supported:

```bash
# Check in release mode
cargo chec --release

# Check a specific package
cargo chec -p my-package

# Check all targets
cargo chec --all-targets

# Combine flags
cargo chec --release --all-targets -p my-package
```

### Custom Input

Parse existing cargo check output instead of running cargo check:

```bash
# From file
cargo chec --input logs.json

# From stdin
cargo check --message-format=json | cargo chec --input -
```

### Output Format

JSON array of strings:

```json
[
  "Error (severity 5) from rustc in src/main.rs at line 10:5-15: cannot find value `x` in this scope",
  "Error (severity 4) from rustc in src/lib.rs at line 5:1-10: unused variable: `y` Related: In src/lib.rs at line 5:1-5: remove this line"
]
```

Empty on no issues: `[]`.

## Troubleshooting

- **Command not found?** Run `cargo install cargo-chec`.
- **No output?** Project has no errors/warnings.
- **Invalid JSON?** If using custom input, ensure valid NDJSON from cargo check.

## Contributing

Open issues/PRs on GitHub. Built for the Rust ecosystem.

## Releasing

Use the provided Justfile for release tasks:

```bash
# Run all checks
just check

# Dry-run publish
just dry-run

# Full release
just release
```

Requires `just` (install via `cargo install just`).

---

## For AI Agents: Workspace Specifications

This section provides structured details for AI tools to understand and interact with the codebase.

### Project Structure

- **Source Code**: `src/main.rs` (single-file binary)
- **Configuration**: `Cargo.toml` (dependencies and metadata)
- **Scripts**: `scripts/` (sh scripts for release tasks)
- **Justfile**: `Justfile` (command runner for release)
- **Build Artifacts**: `target/` (generated by Cargo)

### Dependencies

- `clap`: CLI argument parsing with cargo subcommand support
- `serde_json`: JSON parsing and serialization

### Build Commands

- **Build**: `cargo build --release` â†’ `target/release/cargo-chec`
- **Lint**: `cargo clippy`
- **Format**: `cargo fmt`
- **Test**: `cargo test`
- **Publish**: `cargo publish`

### Runtime Behavior

- **Entry Point**: `main()` in `src/main.rs`
- **Input**: If no `--input`, runs `cargo check --message-format=json` with any additional args passed through
- **Filtering**: Errors (severity 5) and warnings (severity 4) only
- **Output**: JSON array of formatted error strings to stdout

### Code Style

- Idiomatic Rust with `?` operator and iterator chains
- Edition 2021, rustfmt-compliant
